---
output:
  md_document:
    variant: markdown_github
---

# Global Dividend Portfolios

Dividend portfolios should provide some extra return beyond non dividend paying stock because of their income component that makes up total return. For my thesis I plan to investigate whether there is some signalling of returns from dividend paying stock. After looking at vanilla stylized systematic vs benchmark performance.

Following this I will create my own portfolio that aim to capture a global opportunity set. In other words, construct sector dividend portfolios from stock exchanges around the world. 


# Motivation

-To get a clear picture of signalling effect dividend paying securities whilst aggregating a global opportunity set.
-some sectors may have better signalling than others, in the portfolios we construct we will try to uncover wheter this is true or not


# Some requirements 
-Stocks within the sector have to be homogenous. 
-Some diversification benefits across different portfolios. 
-Have to be liquid, in order to take in great amounts of capital. 


# Systematic Dividend Indexes and Benchmark Performance

```{r}

rm(list = ls()) # Clean your environment:
gc() # garbage collection - It can be useful to call gc after a large object has been removed, as this may prompt R to return memory to the operating system.
library(tidyverse)
install.packages("PerformanceAnalytics")
library(PerformanceAnalytics)

Dividend_portfolios <- readxl::read_xlsx("data/Systematic.xlsx")
```
# Cumulative Returns 

In this sections I aim to graph cumulative returns for each index. I will superimpose the benchmark on each stylized index, that way I can get a clear picture of how the dividend portfolio may have performed. 

```{r}
# Get simple returns and make a new dataframe
Returns_df <- Dividend_portfolios %>%
  mutate(across(.cols = 2:24, .fns = ~ ( . - lag(.) ) / lag(.) * 100, .names = "R_{.col}" )) %>%
  select(Date, starts_with("R"))

Returns_df <- Returns_df[complete.cases(Returns_df), ]

# Cumulative return calcs and make a new dataframe

cumulative_df <- Returns_df %>%
  mutate(across(starts_with("R"), ~ cumprod(1 + .) - 1, .names = "C_{.col}")) %>%
  select(Date, starts_with("C")) %>% arrange(Date)


```


```{r}
#Trial Cumulative returns, this is just to see if the above code gives the visuals im looking
Trial_cumulative_df <- cumulative_df %>% select(Date,C_R_M2GBDY , C_R_GDDUUK)


# Making it tidy
plot_data_trial <-Trial_cumulative_df %>% 
  gather(key = "variable", value = "returns", -Date,  na.rm = TRUE) 

# Plot 
g <- ggplot(plot_data_trial, aes(x = Date, y = returns, color = variable)) +
  geom_line() +
  labs(x = "Variable", y = "Returns", title = "Returns Comparison") +
  theme_minimal() 

g + facet_wrap(~variable)
```

```{r}

```

