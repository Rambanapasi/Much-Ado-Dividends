---
# IMPORTANT: Change settings here, but DO NOT change the spacing.
# Remove comments and add values where applicable.
# The descriptions below should be self-explanatory

title: " Much Ado About Dividends"
subtitle: ""

documentclass: "elsarticle"

# --------- Thesis title (Optional - set to FALSE by default).
# You can move the details below around as you please.
Thesis_FP: FALSE
# Entry1: "An unbelievable study with a title spanning multiple lines."
# Entry2: "\\textbf{Some Guy}" # textbf for bold
# Entry3: "A thesis submitted toward the degree of Doctor of Philosophy"
Uni_Logo: Tex/Logo.png # Place a logo in the indicated location (from your root, e.g. defaults to ~/Tex/Logo.png) and uncomment this line. Leave uncommented for no image
# Logo_width: 0.3 # If using a logo - use this to set width (size) of image
Entry4: "Under the supervision of: \\vfill Nico Katzke"
Entry5: "Stellenbosch University"
Entry6: "October 2023"
# Entry7:
# Entry8:

# --------- Front Page
# Comment: ----- Follow this pattern for up to 5 authors
AddTitle: TRUE # Use FALSE when submitting to peer reviewed platform. This will remove author names.
Author1: "Gabriel Rambanapasi"  # First Author - note the thanks message displayed as an italic footnote of first page.
Ref1: "Stellenbosch University, Cape Town, South Africa" # First Author's Affiliation
Email1: "gabriel.rams44\\@gmail.com" # First Author's Email address

Author2: "Nico Katzke"
Ref2: "Satrix, Cape Town, South Africa"
Email2: ""
# CommonAffiliation_12: TRUE # If Author 1 and 2 have a common affiliation. Works with _13, _23, etc.

# Author3: "John Doe"
# Email3: "Joe\\@gmail.com"

CorrespAuthor_1: TRUE  # If corresponding author is author 3, e.g., use CorrespAuthor_3: TRUE

# Comment out below to remove both. JEL Codes only given if keywords also given.
keywords: "" # Use \\sep to separate
JELCodes: ""

# ----- Manage headers and footers:
#BottomLFooter: $Title$
#BottomCFooter:
#TopLHeader: \leftmark # Adds section name at topleft. Remove comment to add it.
BottomRFooter: "\\footnotesize Page \\thepage" # Add a '#' before this line to remove footer.
addtoprule: TRUE
addfootrule: TRUE               # Use if footers added. Add '#' to remove line.

# --------- page margins:
margin: 2.3 # Sides
bottom: 2 # bottom
top: 2.5 # Top
HardSet_layout: TRUE # Hard-set the spacing of words in your document. This will stop LaTeX squashing text to fit on pages, e.g.
# This is done by hard-setting the spacing dimensions. Set to FALSE if you want LaTeX to optimize this for your paper.

# --------- Line numbers
linenumbers: FALSE # Used when submitting to journal

# ---------- References settings:
# You can download cls format here: https://www.zotero.org/ - simply search for your institution. You can also edit and save cls formats here: https://editor.citationstyles.org/about/
# Hit download, store it in Tex/ folder, and change reference below - easy.
bibliography: Tex/ref.bib       # Do not edit: Keep this naming convention and location.
csl: Tex/harvard-stellenbosch-university.csl # referencing format used.
# By default, the bibliography only displays the cited references. If you want to change this, you can comment out one of the following:
# nocite: '@*' # Add all items in bibliography, whether cited or not
 # nocite: |  # add specific references that aren't cited
# @grinold2000
#  @Someoneelse2010

# ---------- General:
RemovePreprintSubmittedTo: TRUE  # Removes the 'preprint submitted to...' at bottom of titlepage
Journal: "Journal of Finance"   # Journal that the paper will be submitting to, if RemovePreprintSubmittedTo is set to TRUE.
toc: FALSE                       # Add a table of contents
numbersections: TRUE             # Should sections (and thus figures and tables) be numbered?
fontsize: 11pt                  # Set fontsize
linestretch: 1.0                # Set distance between lines.
link-citations: TRUE            # This creates dynamic links to the papers in reference list.

### Adding additional latex packages:
# header-includes:
#    - \usepackage{colortbl} # Add additional packages here.

output:
  pdf_document:
    keep_tex: TRUE
    template: Tex/TexDefault.txt
    fig_width: 3.5 # Adjust default figure sizes. This can also be done in the chunks of the text.
    fig_height: 3.5
abstract: |
 This paper tests wheter dividends signals provide informative return predictors. We consider total return global indexes constructed using high yield (HY) or dividend growth per share signals (DG) over a sample of 20 years. We find that global indexes fail to meaningfully  outperform their market index as measured by cumulative excess return and mean return. Upon stratification, we observe that all stratgeies offer defensive charcateristics in periods of high volatility and HY strategies give their highest return in periods of low interest rates. Underscoring our total return analysis we conclude that all strategies have underperfomed on a rolling 60 month basis in most geographies, hence they are a poor proxy for capturing the value premium. For the local, we construct our own dividend portfolios, using a Maximum Utility Optimizer, applying a ranking criteria similar to @damodaran2004investment and find that both DG and HY underperform the Capped SWIX Top 50. However, our value proxy (price to earnings) outperforms our dividend signals. We opine that if investors are inclined to have dividend exposure in their, portfolio we recommnded investors use DG considering that being a delta to HY offers a purer measure of value. 
---
<!-- First: Set your default preferences for chunk options: -->

<!-- If you want a chunk's code to be printed, set echo = TRUE. message = FALSE stops R printing ugly package loading details in your final paper too. I also suggest setting warning = FALSE and checking for warnings in R, else you might find ugly warnings in your paper. -->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width = 6, fig.height = 5, fig.pos="H", fig.pos = 'H')
# Note: Include = FALSE implies the code is executed, but not printed in your pdf.
# warning and message = FALSE implies ugly messages and warnings are removed from your pdf.
# These should be picked up when you execute the command chunks (code sections below) in your rmd, not printed in your paper!

# Lets load in example data, and see how this can be stored and later called from your 'data' folder.
if(!require("tidyverse")) install.packages("tidyverse")
library(gt)
library(tidyverse)
library(huxtable)
library(kableExtra)
library(xtable)
library(fmxdat)
pacman::p_load("TTR")
pacman::p_load("tidyr", "tbl2xts","devtools","lubridate", "readr", "PerformanceAnalytics", "ggplot2", "dplyr")
source("code/EXCESSRETURN.R")
source("code/Theme.R")

# loadings
pacman::p_load("xts", "tidyverse", "tbl2xts", "PerformanceAnalytics", 
               "lubridate", "glue", "zoo")

df<- readxl::read_xlsx("data/MAD .xlsx")

#  change the column names for ease of analysis

geographical_codenames <- c("UK_HY", "EM_HY", "UK", "EM", "UK_HY_B", "UK_B", "JP_HY", "EU", "US_HY", "US", "W_HY", "W", "EU_DG", "EU_2", "JP_DG", "US_DG", "US_2", "JP", "SA_DG", "SA", "SA_HY", "EU_HY", "W_HY", "W")

# always working with those indexes
colnames(df)[2:23] <- geographical_codenames

```
<!-- ############################## -->
<!-- # Start Writing here: -->
<!-- ############################## -->
# Introduction {-}

This paper seeks to investigate the return signalling cue of dividend paying stock. The value of dividends towards shareholders has long been debated with academics and practitioners providing evidence for their irrelevance and relevance. @miller proposed the dividend irrelevance theorem that essentially argues that dividend payments were irrelevant as this detracted from the shareholder value as wealth is affected by the income a firm generates, not the way the firm distributes that income. Against this, @gordon1962 argued that cash flows should be preferred by investors , as they are certain, as opposed to the riskier capital gains according this theory, Bird in hand Theorem is used to justify demand for dividend stock, especially for the less riskier investor. Moreover, a deeper assessment of the MM theory reveals unrealistic assumptions, rendering arguments immaterial once real world constraints such as taxes and transactions cost, behavioural biases are considered.  Consequently theories that consider information asymmetries, tax considerations, signalling all give convincing arguments of dividend payment address some real world considerations. @campbell2017financial opines that the value of a stock is a function of its future cashflow, if  markets are assumed to be efficient then companies that do not pay dividends should have a value of zero unless there is some expectation of the future reciepts of investment is said company. Therefore, we can safely assume a direct relationship between share price and new information that affects future cash flows. Event studies on types dividend payments address this and often times it is noted that the payment of dividends leads to a decrease in prices thus stock valuation, @suwanna2012impacts shows that dividend announcement decrease share prices to the value of the dividend. This could be that dividend are a capital budgeting decision and their payment reduces retained earnings and consequently affects that the share price. 

This study provides an extensive investigation into the return signaling of dividend portfolios. Firstly, looking at past literature on dividend payments, their rationale, theories for and against their relevance in the literature review. Secondly, outline our methodology in constructing our dividend portfolios, which includes our utility optimizer along with constraints.  Thirdly, start to discuss the results of our study by answering the first question of when do dividend signals work? To achieve this we first look at the cumulative excess returns offered by globally dividend indexes, to give a holistic picture of geographical dividend portfolio performance. Our analysis shows us that dividend portfolios, wheter high yield (HY) or dividend growth (DG) do not give an clear signal to return, however once we stratify our sample according to interest rate cycles (Hiking,  Cutting and Neutral) and market regimes (High and Low Volatility), unique to geography and we start to find that within market regimes,  dividend signals offer defensive characteristics, thus giving higher excess returns in periods of High Volatility. This does not infer positive return for all indexes, our proxies for United States (US) HY , UK HY and World indexes returned negative over their respective periods. On performance consistency, rolling information ratio, we note an inherent lack of consistency in dividend portfolios performance, with most staretgies underperforming the benchmark over the past 15 years. However, coupled with draw downs experienced in different jurisdictions, we acknowledge that advanced market dividend portfolios experience the least variation in draw downs compared to emerging markets. The results indicate that both growth and high-yield dividend portfolios tend to under perform relative to their benchmarks, raising questions about their ability to extract a value premium. Lastly, move on to how dividend portfolios work, with the goal of constructing a portfolio that can best harness the existing premium. We use share data from the Johannesburg Stock Exchange (JSE), with our benchmark being the Capped SWIX Top 50. We construct four portfolios using 3-month and 9 month measures of HY, 1 and 3 year DG measures together with price momentum and dividend coverage ratios. Similar to the analysis on international dividend portfolios, our portfolios exhibit defensive properties in High volatility periods but fail to capture a premium consistently over investing in a market index.  

# Literature Review {-}
## What are dividends {-}

Dividends constitute a form of capital distribution by corporations towards shareholders. They exist in various forms, such as cash, stock, liquidating, scrip, or property dividends  @baker1999corporate, of which cash dividends and share repurchases being the most commonly used in practice. Within cash dividends, regular dividends are widely used by corporations and payment frequency across jurisdictions. The decision to issue dividends is typically made by the board of directors, and approved by shareholders, however practiced more in Europe and less so in the United States. The payout policy policy of a corporation, which are guiding principles for management and board of directors towards capital distributions considers company investment and is closely watched by investors and analysts. As such, management strives to grow or maintain a certain level of dividend payouts as this signals firm growth and investors share of profitability in the company. 

## Theorectical Arguments on Dividend Payments {-}

Given the apparent decrease in shareholder value, the logical question has encouraged a long running debate on dividend relevance and irrelevance. In 1961, @miller1985dividend opined that dividends are irrelevant (MM theory), he argued that shareholders are indifferent to dividend payments, thus implying that there is no optimal dividend policy and that all dividend policies are equally good and payments of dividends could easily be reinvested in shares and make no difference to share holder wealth. However, the MM theorem fails to consider real-world market imperfections that may give relevance to dividend payments. The bird in the arguments opposes the MM theory, suggesting that investor would prefer to receive less risky cash flow in the form of dividends instead of potential capital gains at some point in the future [@gordon1962]. This permeates to the cost of equity, since dividends are less risky, companies that issue more dividends should have higher share prices.  However, propoents of the MM theory contend this suggesting the risk of future cash flow is affected by the payment of dividend, leading to negative effects on share prices after the ex-dividend date. The dividend puzzle considers real world constraints and gives an interesting take on its relevance and irrelevance, by suggesting that dividends reduce equity value and make investors worse off; however, are a reward to investors who bear the risk associated with their investments as it provides an additional source of return on investment from a share  @black1996dividend. Various literature has made convincing arguments for corporations to pay dividends which include tax considerations, dividend signalling and agency costs in issuing dividends.Tax considerations argue in favor for dividend relevance. Across jurisdiction dividends have different tax treatments to capital gains and often tax at a higher income tax rate, thus investors that have higher tax rates choose stocks with lower dividend payouts and transversly pushes up the stock price, this is called the clientele effect [@van2013advanced \& @baker1999corporate]. However a major pushback emanates from proponents of the MM theory, that suggest the client effect causes major substitution effect, meaning that if companies change their dividend policy, investors with preferential tax treatment will simply allocate more capital to that stock and those out of favor will sell their shares. Given the large number of investors versus listed companies the process is instantaneously causing a net zero effect on prices[@baker1999corporate].  Second, flotation costs refer to the opportunity costs incurred by a firm when paying dividends. Through distributing dividends, companies forego opportunities to expand their operations using retained earnings. In a world without flotation costs, as suggested by the MM theorem, management would be indifferent between issuing dividends and borrowing from the market thus have no effect on shares prices. However, in reality, external financing comes at a higher cost, leading to trade-offs in dividend policy decisions and ultimately share prices.

Information asymmetry between shareholders and managers is another factor that gives relevance to dividend payments. Managers of businesses have greater knowledge of operations thus value of a business at any given point more than shareholders. As such,  investors rely on dividend announcements to assess a company's valuation. Dividend signaling conveys information about the company's quality [@al2018revisiting \& @baker1999corporate]. Investors compare dividend announcements to historical levels while considering company fundamentals. However, a major concern towards its ability to be "gamed' by management, making the dividend signal imperfect for determining share prices.  Principal agency issues may give another reason for issuance of dividends. The free cash flow hypothesis suggests that dividend payments force management to raise capital from external sources, which increases borrowing costs and scrutiny from capital markets. This, in turn, reduces management's ability to make sub optimal investments and aligning management and shareholder objectives [@baker1999corporate]. Supporters of this theory ascertain that dividends payments by the mechanism encourage good business practices.

## Constructed Dividend Portfolios {-}

From the dividend relevance theories we can conclude that the payments of dividends emanates from proxy arguments (as opposed to it being considered an attractive feature in itself).  High dividend-paying companies could proxy for the quality of management structures over time (through their ability to consistently afford dividend payments) or similarly point to prudent cash-flow management capabilities and stock closely resemble value stock. @basu1977investment used price to earnings ratios of companies to predict stock performance of companies, and found that low price to earnings stock overtime out perform their more expensive counterparts that have high PE ratios. So when we consider the following, $D Y=\frac{E P S}{\text { Price }} \times Payout Ratio$, dividend yield, once payout ratio is held constant, is a function of earnings yield, therefore identifying low price to earnings through dividends can lead us to use it as a proxy for value. This measure is not full proof, value stock carry  high levels of risk as there more prone to be under financial distress and face uncertainty in future earnings [@chen1998risk]. For this reason, the use of dividend growth (DG) as a signal provides attributes that aim to curtail negative aspects of dividend yield (HY). That is, DG stock, unlike HY, it is not affected by price but maintains properties that allow for inference into management quality. As management is aware of the signaling effect of dividends, this may induce the value trap, forcing management to continually increase dividends to maintain a certain valuation. However, such companies are more vulnerable to facing financial distress [@baker2009understanding]. @o1991beating constructed a portfolio of companies that used constituents of the  Dow Jones Industrial Average (DJIA) called the "Dogs of the Dow" (DOD). By ranking 30 companies by HY and including only the 10 highest-yielding shares in a portfolio, this achieved a return higher than the DJIA (16.6% per annum versus the DJIA's 10.4%). This had lower risk than the DJIA, thus achieving a higher Sharpe Ratio. Testing @o1991beating's strategy resulted in "Beat the Dow 5," which involved annually investing in only the five lowest-priced of the HY10 shares each year, in other words, high dividend yield. This strategy gave superior returns of 19.4% versus the DJIA. As opined by @gardner2002motley, this strategy leverages the fact that low-priced stocks experience the most volatility, by courting future volatility in the 10 stocks that have some potential upside, expecting their stock prices to rise in return. Other studies across jurisdiction came to similar conclusions, @lemmon2015dividend in Hong Kong, @brzeszczynski2007dividend in Poland, @visscher2003dividend in Canada, @filbeck1997 in Britain, and @wang2011dogs in China. More recently, @filbeck2017dividend investigated the performance of DOD against a high-yield portfolio of Fortune Most Desired Companies (MAC) compared to the Dow Jones Industrial Average and the S&P 500. The study found significantly higher risk-adjusted returns for the DOD strategy. In South Africa, @fakir2013dividend employs a parametric approach to investigate dividends as an investment strategy.

# Methodology {-}
To evaluate the return predictive signal of dividends, we employ an applied approach that constitutes constructing subset portfolios and compare in sample performances. Our approach aims to give valuable insights based on risk and return for systematically constructed dividend portfolios.  

## Portfolio optimzation{-}

The Modern Portfolio Theory defines risk of a portfolio of ($n$) assets as the variance ($\sigma^2$) of its returns ($r_{t}$). We add a refinement to this, and our definition returns is achieved by decomposing it into common factor ($Xf$) and specific return ($u$) as ($r = Xf+ u$). From these returns we create a factor covariance matrix, defined as ($X F X^T+D$) in which we derive our multiple factor universe consists of ($k$) common factors.

$\begin{array} {ll}X & =n \times k \text { matrix of asset exposures to the factors, } \\ F \quad &= k \times k \text { positive semi-definite factor covariance matrix, and } \\ D \quad &=n \times n \text { positive semi-definite covariance matrix representing a } \\ & \text { forecast of asset specific risk. }\end{array}$

We periodically calculate each asset exposure to the common factors calculated in the factor covariance matrix. This then assists us in computing forecasts of the level of each asset specific risk. The short term risk forecasts will then be used to gauge contribution of each asset to a portfolio over risk which contributes to the portfolio construction process. For our optimization,  risk takes on two forms being total risk (only portfolio holdings are considered and benchmark holdings are irrelevant for the optimization process) and active risk (difference between portfolio holdings and benchmark holdings are given consideration in the optimization problem). 

Defined as:
*Total Risk*: $\quad h^T\left(\lambda_F X F X^T+\lambda_D D\right) h$

*Active Risk*: $\left(h-h_B\right)^T\left(\lambda_F X F X^T+\lambda_D D\right)\left(h-h_B\right)$

where,
$$
\begin{aligned}
\lambda_F & =\text { common factor risk aversion parameter, } \\
\lambda_D & =\text { specific risk aversion parameter, } \\
h & =n \times 1 \text { vector of managed portfolio's holdings, and } \\
h_B & =n \times 1 \text { vector of normal (benchmark) portfolio's holdings }
\end{aligned}
$$
## Constraints{-}

Optimization involves using set of constraints that helps in attaining convergence, i.e giving a set of weights that determine our optimum portfolio. In practice, this is unique to portfolio managers given their risk objectives and goals^[see https://www.sciencedirect.com/science/article/pii/S1057521921002556 for a detailed explanation on advantages of using maximum utility operators to efficiently factor investor risk preferences]. 

We use: 

- Common factor and specific risk aversion parameters of 0.0075 and 1, respectively. 
- Our investment universe is the Top 50 stock listed on the JSE,therefore our selection criteria depends on market capitalization and liquidity. We use the Capped SWIX as the benchmark. 
- Portfolios  are re-balanced quarterly. 
- Active risk constraints to parent benchmark 5%
- Our sector exposure has a +/-10% limit; holds no property stocks in the portfolio
- Individual stock have a 15% max exposure limit
- Quarterly turnover is limited to 10%. \

### Tax considerations{-}

Portfolio theory was developed in a perfect world without friction. In practice, frictions need to be considered and in portfolio construction this often entails considering the effect of taxes on income and capital gains as they can erode returns and significantly alter risks and return characteristics of shares. The contribution of dividends and capital gains to total return can lead to varying tax inefficiencies for shares as most  jurisdictions imposed higher taxes than on capital gains. Therefore shares with higher contribution of dividends will be less tax efficient than those with a higher capital gains component and with timing most jurisdictions tax dividends in the year that they are receive^[See Deloitte’s tax guides and country highlights: https://dits.deloitte.com/#TaxGuides].

Jurisdictional laws can also affect the distribution of taxable returns amongst shares depending on their class namely ordinary shares or preferred shares. Preferred shares are viewed as a substitute for bonds and income from preferred shares are often given tax at a lower rate than those from dividends from ordinary shares.

We will not survey global tax regimes or incorporate all potential tax complexities into the portfolio construction but  assume a  high level commonalities exists amongst all jurisdictions this study  uses. This is a reasonable assumption considering  the summary of taxes on dividends and capital gains from major economies.  For simplicity, we will assume a basic tax regime  includes the key elements of investment-related taxes that are representative of what a typical taxable asset owner of a global portfolio will contend with. The proposed methodology to employ on the dividend portfolios use the following methodology. 

\begin{align}
r_{a t}=p_d r_{p t}\left(1-t_d\right)+p_a r_{p t}\left(1-t_{c g}\right) \notag
\end{align}

where:
$$
\begin{aligned}
r_{at} & =\text { the after tax return} \\
p_{d} & =\text {total return from to dividend income } \\
p_{a} &= \text { total return from capital appreciation } \\
t_{d}&= \text { tax on dividends}\\
t_{a}& = \text { tax on capital gains }
\end{aligned}
$$

## Dividend Signals{-}

 In constructing our portfolios, we rank the stocks on the capped SWIX according to the either a dividend yield and dividend growth per share. Our in house measures for dividend yield (DY 3m fwd and DY 9m fwd) are constructed based on industry analyst estimates on future earnings, hence the appeal is that the measure is a forward looking estimate^[ this ensures that we mitigate against the *value trap*.] Similarly,  dividend growth measure of either 1 and 3 years are constructed on forward looking estimates for the same reasons. We employ a price momentum  and dividend coverage filters to construct portfolios that reward companies which have had strong price momentum and sustainable dividend practices[mention studies that have shown that employing price momentum filters helps with picking the right stock for a portfolio].  

### DIVI1 {-}

Rank score (i.e. between 0 and 100) calculated using:

We use a combination of 2/3 DY (3m fwd) and 1/3 DY (9m fwd), Dividend Coverage Ratio and Price Momentum. The signal uses conditions:
- if dvd_cover score is in bottom quintile, then add it at 15% (15% dvd cover, 66.667% * 0.85 DY3m, 33.333% * 0.85)
if Price momentum score is in bottom quintile, then add it at 35% (35% PX momentum score = 66.667% * 0.65 DY3m, 33.333% * 0.65)
- if both dvdcover and momentum in bottom quintile, then: ( 15% dvd cover score=  35% PX momentum score, 66.667% * 0.5 DY3-month, 33.333% * 0.5)

This portfolio uses price momentum and dividend cover ratio as filters to the dividend yield. This rewards sustainability in dividend paymensts and avoids comapnies that  companies that can not afford to pay shareholders dividends thus avoid reactionary capital gain losses. 

### DIVI2 {-}
Rank score (i.e. between 0 and 100):

We use the dividend as the only signal. Similar to Divi1 its a blend of forwarding looking metrics. That is,  2/3 DY (3m fwd) and 1/3 DY (9m fwd). 

This is our vanilla dividend yield portfolio i.e. just ranks according to the highest dividend payers. 

### DIVI3 {-}

Rank score (i.e. between 0 and 100):

We use the P/E ratio as the alternative proxy to value. 

### DIVI4 {-}
Rank score (i.e. between 0 and 100) calculated using:

Using:
DPS_Growth_1Y = 40%, DPS_Growth_3Y = 30%, Fwd_3 = 20%, Fwd_9 = 10%

Our dividend growth portfolio using trailing dividend growth rates coupled with 3 and 9 month forward measures. 


## Data {-}

Our metric of interests in this study are return and risk measures to evaluate dividend signals as an ionvestment strategy. We use data from dividend portfolios over the period 30/06/03–30/06/23, with the start date and the end date purely driven by data availability on the selected dividend indices at the time of writing. We obtained historical daily price data of the dividend portfolios and constituents of the Capped SWIX Top 50 listed in the Johannesburg Stock Exchange (JSE) from Bloomberg^[see \ref{reftab} for a detailed guide to indices used and codenames used later in the results and analysis]. Also we retrieved volatility and interest rate proxies for geograhies under investigation for the same sample period as our dividend portfolios. That is, Chicago Board of Options Exchange (CBOE) VIX Index for the US and EM, V2X for Europe, IVUK for UK and JALSH VR for SA volatility proxies. For interest rate data we considered policy rates for central banks for instruments geography within our study, these are the Federal Fund rate for the US and EM, Minimum Deposit Financing Rate for the EU, Bank of England Bank Rate and the South African Reserve Bank Repo rate. To this end, we calculate our excess returns, we geometrically chain the excess returns for the different periods before annualizing. This produces comparable cumulative annualized excess return (CAER) results in \ref{tab1}, defined as:
\begin{align}
C A E R=\left[\prod_{t=1}^n\left(1+E R_t\right)\right]^{\frac{222}{n}}-1 \notag
\end{align}

Our rule to identifying volatility periods either high volatility (Hi-vol) or low volatility (Lo-vol) is achieved by computing the top and bottom quantile in standard deviation for our respective proxies. We then pull the dates corresponding to the periods, and compute annualized returns after geometrically chaining the monthly returns. The amount of daily data for the respective interest rate cycles is large enough to annualized, however, when the VIX,
V2X or JALSH RV breach the top or bottom quintile for less than 50 trading days, the period is excluded in order to
avoid annualizing small samples. To stratifying between Hiking, Cutting and Neutral interest rate cycles we define these periods as either 5 quarters of changes (upwards for Hiking and downwards for Cutting) or otherwise if central bank held interest rates constant. 

# Results and Discussion{-}

## When Do Dividend Strategies Work {-}

We first evaluate several performance metrics of globally traded dividend portfolios^[ Table \ref{tab1} does not compare across indexes and regions as instruments have different inception dates ]. Table \ref{tab1} shows four performance measures in relative return (annualized excess return) and total return(cumulative return), maximum draw downs and standard deviation. The last two measures give an idea of risk characteristics of our selected investment universe, however  an in depth analysis will follow in our analysis. Immediately we notice that total returns as measured by cumulative returns for the dividend portfolios that we investigate are positive for approximately 42% of the sample. Specifically, HY strategies provide the highest total returns, and coupled with annualized excess returns assessement, we notice that most strategies beat their benchmark, however, their relative performance against their respective benchmarks is marginal with relative performance being +/- 0.01%. Looking at risk from a very high level, there exists a tight range in annualized standard deviation with most strategies, however draw downs vary across strategies and regions and dont give a clear pciture of return characteristics of the constituents, but broadly HY strategies have lower draw downs than DG strageties. Therefore, from table \ref{tab1} there exists no clear evidence that dividend signals are able to capture some premium over the market index regardless of region.

```{r Table1, results='asis'}

a <- readxl::read_xlsx("data/output.xlsx")

# this is the pre ample to the overall portfolio nalaysis that I will be conducting

data <- a %>% tibble::as_tibble()

table <- xtable(data, caption = "Global Index  Portfolio Performance \\label{tab1}")
  print.xtable(table,
             # tabular.environment = "longtable",
             floating = TRUE,
             table.placement = 'H',
             # scalebox = 0.3,
             comment = FALSE,
             caption.placement = 'bottom'
             )
```

We see a clearer picture emerge once we stratify dividend global portfolio performance according to market volatility and interest rate cycles. Our market volatility is categorized into two distinct cycles: the "High Vol" and "Low Vol", this is conducted by first, calculating the rolling 12 month standard deviations of volatility proxies, second taking the 5 and 95 percentile of observations and pulling corresponding dates. Subsequent to this stratification, we geometrically chain excess returns in these periods and annualize excess returns with the appropriate periodicy.  Table \ref{tab2} and \ref{tab3} shows performance in periods of market distress (Hi Vol) or market calm (Lo vol). Unlike our results from \ref{tab1}, stratification enables comparison across regions and strategies, however, being cognizant of duration in market volatility and may affect strategy performance. From our stratification, 37.5% of observations yield positive excesss returns. Of those, HY indexes (which make up a proportion of 67% of those with positive returns), we notice that most strategies give the highest return in periods of market distress versus  market calm and most index in this market distress give returns close to 0%.  Considering Hi Vol, HY always outperform DG strategies, i.e. SA_HY (2.74%) outperforms SA_DG (-4.07%) , EU_HY (0.08%) outperforms EU_DG (-4.84%)  and  US_HY (-0.35%) outperforms US_DG (-0.68%). In Lo Vol periods, we notice greater dispersion in annualized excess returns and thus no real indication of wheter longer duration of calmness lead to lower returns, the performance is less concrete in low volatility periods. From our market cycle stratification HY and DG strategies offer defensive characteristics in periods of higher volatility however, only a few of our portfolios give positive excess return in those periods, as such idiosyncrasies within market determine signal performance. 

```{r Table2, results='asis'}

 vol_data <- readxl::read_xlsx("data/volatility for indexes.xlsx") %>% gather(index, px , -Date) %>% 
  mutate(ret = px/lag(px)-1, RollSD = RcppRoll::roll_sd(1 + ret, 12, fill = NA, align = "right") * 
             sqrt(12)) %>% 
    filter(!is.na(RollSD))

# # get the top quartile and bottom quartile
 strat_df <- vol_data %>% filter(index == "VIX") %>%  mutate(topQ = quantile(RollSD, probs = 0.90), 
               botQ = quantile(RollSD, probs = 0.1),
               Strat = ifelse(RollSD >= topQ, "HiVol", 
                           ifelse(RollSD <= botQ, "LowVol", "Normal_Vol")))
 
# # US strat
 
 hivol_per_vector_us <- strat_df %>% filter(Strat %in% "HiVol") %>% pull(Date)
 lovol_per_vector_us <- strat_df %>% filter(Strat %in% "LowVol") %>% pull(Date)

 # UK 

 strat_df <-vol_data %>% filter(index == "IVIUK") %>% mutate(topQ = quantile(RollSD, probs = 0.90), 
               botQ = quantile(RollSD, probs = 0.1),
              Strat = ifelse(RollSD >= topQ, "HiVol", 
                          ifelse(RollSD <= botQ, "LowVol", "Normal_Vol")))
# 
 hivol_per_vector_uk  <- strat_df %>% filter(Strat %in% "HiVol") %>% pull(Date)
 lovol_per_vector_uk  <- strat_df %>% filter(Strat %in% "LowVol") %>% pull(Date)
#  EU 
 
 strat_df <-vol_data %>% filter(index == "V2X") %>% mutate(topQ = quantile(RollSD, probs = 0.95), 
               botQ = quantile(RollSD, probs = 0.05),
              Strat = ifelse(RollSD >= topQ, "HiVol", 
                          ifelse(RollSD <= botQ, "LowVol", "Normal_Vol")))
# 
 hivol_per_vector_eu  <- strat_df %>% filter(Strat %in% "HiVol") %>% pull(Date)
 lovol_per_vector_eu  <- strat_df %>% filter(Strat %in% "LowVol") %>% pull(Date) 
# # SA 

 strat_df <-vol_data %>% filter(index == "SAVIT40") %>% mutate(topQ = quantile(RollSD, probs = 0.9), 
               botQ = quantile(RollSD, probs = 0.1),
               Strat = ifelse(RollSD >= topQ, "HiVol", 
                           ifelse(RollSD <= botQ, "LowVol", "Normal_Vol")))
# 
 hivol_per_vector_sa <- strat_df %>% filter(Strat %in% "HiVol") %>% pull(Date)
 lovol_per_vector_sa <- strat_df %>% filter(Strat %in% "LowVol") %>% pull(Date)

#  High Vol df 
 
source("code/Stratifier.R")
  
stratifying_df <-  bind_rows(
 stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol" ),
 stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol" ),
 stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol" ),
 stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol"),
 stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol"),
 stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol"),
 stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol"),
 stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol"),
 stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol"),
 stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol"), 
 stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol"), 
 stratifier(df , "W_HY", "W", hivol_per_vector_us, "High Vol"), 
 stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
 stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
 stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
 stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
 stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
 stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
 stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
 stratifier(df, "SA_HY", "SA", lovol_per_vector_sa, "Low Vol Period" ),
 stratifier(df, "SA_DG", "SA", lovol_per_vector_sa, "Low Vol Period" ),
 stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ), 
 stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" ), 
 stratifier(df, "W_HY", "W", lovol_per_vector_us, "Low Vol Period")
 )

stratifying_df_o <- stratifying_df %>% arrange(desc(`Annualized Return (%)`)) %>% arrange(desc(`Annualized Return (%)`)) %>% filter(`Annualized Return (%)`>0)
stratifying_df_u <- stratifying_df %>% arrange(desc(`Annualized Return (%)`)) %>% arrange(desc(`Annualized Return (%)`)) %>% filter(`Annualized Return (%)`<0)

data_o = stratifying_df_o %>% tibble::as_tibble()
  addtorow          <- list()
  addtorow$pos      <- list()
  addtorow$pos[[1]] <- c(0)
  addtorow$command  <- c(paste("\\hline \n",
                               "\\endhead \n",
                               "\\hline \n",
                               "{\\footnotesize Continued on next page} \n",
                               "\\endfoot \n",
                               "\\endlastfoot \n",sep=""))
data_u = stratifying_df_u %>% tibble::as_tibble()
  addtorow          <- list()
  addtorow$pos      <- list()
  addtorow$pos[[1]] <- c(0)
  addtorow$command  <- c(paste("\\hline \n",
                               "\\endhead \n",
                               "\\hline \n",
                               "{\\footnotesize Continued on next page} \n",
                               "\\endfoot \n",
                               "\\endlastfoot \n",sep=""))
  
table <- xtable(data_o, caption = "Over Performance Volatility Stratification\\label{tab2}")
  print.xtable(table,
             tabular.environment = "longtable",
             floating = FALSE, # Leave this as is.
             table.placement = 'H', # Leave this as is.
             booktabs = T, # Aesthetics
             include.rownames = FALSE,  # Typically you don't want this in a table.
             add.to.row = addtorow, # For adding the Continued on next page part...
             comment = FALSE,
             caption.placement = 'bottom',  # Where do you want the caption?
             size="\\fontsize{12pt}{13pt}\\selectfont"  # Size of text in table..
             )
  
table <- xtable(data_u, caption = "Under Performance Volatility Stratification\\label{tab3}")
  print.xtable(table,
             tabular.environment = "longtable",
             floating = FALSE, # Leave this as is.
             table.placement = 'H', # Leave this as is.
             booktabs = T, # Aesthetics
             include.rownames = FALSE,  # Typically you don't want this in a table.
             add.to.row = addtorow, # For adding the Continued on next page part...
             comment = FALSE,
             caption.placement = 'bottom',  # Where do you want the caption?
             size="\\fontsize{12pt}{13pt}\\selectfont"  # Size of text in table..
             )

```
Once we consider stratifying according to interest rate cyles in Table \ref{tab4} and \ref{tab5}, specifically assessing excess returns in Hiking, Cutting, and Neutral cycles. Japan stands as an anomaly among these economies i.e. it does not have  hiking or cutting cycles, its central bank largely maintained constant rates. Consequently, we assess its performance exclusively within the confides of a neutral interest rate cycle. Once stratified, we geometrically chain, quarterly excess returns before we annualized to compare between indices. We find that the average and median annualized cumulative excess returns of the US and EU  dividend indexes during cutting cycles indicate that DG strategies outperform, especially when interest rates decline.  Under performance during hiking cycles is less pronounced in the US when taking into account annualized excess ruturn between Hiking and Cutting cyclees. In the EU, HY and growth both outperform during hiking cycles (dividend growth outperforms to a larger extent). To aid this analysis, in Appendix 2 we show results of  a principal component analysis on returns of each dividend portfolio and benchmark. After finding the principal components,  we regress the first 3 principal components to returns to formalize our assessment on the return drivers for our portfolios. Dividend portfolios either HY or DG have similar loading their relative benchmarks, albeit slightly larger. As there are practical considerations in constructing indexes and coupled with results from our models, we opine that dividend portfolio may proxy the market index and thus give investors exposure similar to the hypothetical index. 
```{r Table3, results='asis'}
rate_data <- readxl::read_xlsx("data/Policy Rates.xlsx") 

names <- c("Date", "US", "UK", "JP", "ECB", "SA")

colnames(rate_data) <- names

US_rates <- rate_data %>% select(Date, US)
UK_rates <- rate_data %>% select(Date, UK)
JP_rates <- rate_data %>% select(Date, JP)
SA_rates <- rate_data %>% select(Date, SA)
ECB_rates <- rate_data %>% select(Date, ECB)
# Get Rates for the US
source("code/Interest_Regime.R")
source("code/Stratifier_rates.R")


#  rename the columns for the function to work

Regime_df <- Regime_change_df(US_rates, "US", 5)
Hiking_date_vector_us <- Regime_df %>% filter(regime %in% "Hiking") %>% pull(Date)
Cutting_date_vector_us <- Regime_df %>% filter(regime %in% "Cutting") %>% pull(Date)
Neutral_date_vector_us <- Regime_df %>% filter(regime %in% "Neutral") %>% pull(Date) 

Regime_df <- Regime_change_df(UK_rates, "UK", 5)
Hiking_date_vector_uk <- Regime_df %>% filter(regime %in% "Hiking") %>% pull(Date)
Cutting_date_vector_uk <- Regime_df %>% filter(regime %in% "Cutting") %>% pull(Date)
Neutral_date_vector_uk <- Regime_df %>% filter(regime %in% "Neutral") %>% pull(Date) 

Regime_df <- Regime_change_df(JP_rates, "JP", 5)
Hiking_date_vector_jp <- Regime_df %>% filter(regime %in% "Hiking") %>% pull(Date)
Cutting_date_vector_jp <- Regime_df %>% filter(regime %in% "Cutting") %>% pull(Date)
Neutral_date_vector_jp <- Regime_df %>% filter(regime %in% "Neutral") %>% pull(Date) 

Regime_df <- Regime_change_df(SA_rates, "SA", 5)
Hiking_date_vector_sa <- Regime_df %>% filter(regime %in% "Hiking") %>% pull(Date)
Cutting_date_vector_sa <- Regime_df %>% filter(regime %in% "Cutting") %>% pull(Date)
Neutral_date_vector_sa <- Regime_df %>% filter(regime %in% "Neutral") %>% pull(Date) 

Regime_df <- Regime_change_df(ECB_rates, "ECB", 5)
Hiking_date_vector_eu <- Regime_df %>% filter(regime %in% "Hiking") %>% pull(Date)
Cutting_date_vector_eu <- Regime_df %>% filter(regime %in% "Cutting") %>% pull(Date)
Neutral_date_vector_eu <- Regime_df %>% filter(regime %in% "Neutral") %>% pull(Date) 
# Hiking Performance

Hiking_performance <-  bind_rows(
 stratifier_rates(df, "EU_HY", "EU", Hiking_date_vector_eu, "Hiking" ),
 stratifier_rates(df, "EU_DG", "EU_2", Hiking_date_vector_eu, "Hiking" ),
 stratifier_rates(df, "UK_HY", "UK", Hiking_date_vector_uk, "Hiking" ),
 stratifier_rates(df, "UK_HY_B", "UK", Hiking_date_vector_uk, "Hiking" ),
 stratifier_rates(df, "EM_HY", "EM", Hiking_date_vector_us, "Hiking"),
 stratifier_rates(df, "SA_HY", "SA", Hiking_date_vector_sa, "Hiking" ),
 stratifier_rates(df, "SA_DG", "SA", Hiking_date_vector_sa, "Hiking" ),
 stratifier_rates(df, "US_HY", "US", Hiking_date_vector_us, "Hiking" ), 
 stratifier_rates(df, "US_DG", "US", Hiking_date_vector_us, "Hiking" )
 )

#  Cutting Perfromance

Cutting_performance <-  bind_rows(
 stratifier_rates(df, "EU_HY", "EU", Cutting_date_vector_eu, "Cut" ),
 stratifier_rates(df, "EU_DG", "EU_2", Cutting_date_vector_eu, "Cut" ),
 stratifier_rates(df, "UK_HY", "UK", Cutting_date_vector_uk, "Cut" ),
 stratifier_rates(df, "UK_HY_B", "UK", Cutting_date_vector_uk, "Cut" ),
 stratifier_rates(df, "EM_HY", "EM", Cutting_date_vector_us, "Cut"),
 stratifier_rates(df, "SA_HY", "SA", Cutting_date_vector_sa, "Cut" ),
 stratifier_rates(df, "SA_DG", "SA", Cutting_date_vector_sa, "Cut" ),
 stratifier_rates(df, "US_HY", "US", Cutting_date_vector_us, "Cut" ), 
 stratifier_rates(df, "US_DG", "US", Cutting_date_vector_us, "Cut" )
 )

# Nuetral 

Nuetral_perfromance <-  bind_rows(
 stratifier_rates(df, "EU_HY", "EU", Neutral_date_vector_eu, "Neutral" ),
 stratifier_rates(df, "EU_DG", "EU_2", Neutral_date_vector_eu, "Neutral" ),
 stratifier_rates(df, "UK_HY", "UK", Neutral_date_vector_uk, "Neutral" ),
 stratifier_rates(df, "UK_HY_B", "UK", Neutral_date_vector_uk, "Neutral" ),
 stratifier_rates(df, "JP_HY", "JP", Neutral_date_vector_jp, "Neutral" ),
 stratifier_rates(df, "JP_DG", "JP", Neutral_date_vector_jp, "Neutral" ),
 stratifier_rates(df, "EM_HY", "EM", Neutral_date_vector_us, "Neutral"),
 stratifier_rates(df, "SA_HY", "SA", Neutral_date_vector_sa, "Neutral" ),
 stratifier_rates(df, "SA_DG", "SA", Neutral_date_vector_sa, "Neutral" ),
 stratifier_rates(df, "US_HY", "US", Neutral_date_vector_us, "Neutral" ), 
 stratifier_rates(df, "US_DG", "US", Neutral_date_vector_us, "Neutral" )
 )

CB_df <- bind_rows(Nuetral_perfromance, 
 Cutting_performance, Hiking_performance) %>% arrange(desc(`Annualized Return (%)`))

CB_o <- CB_df %>% rename(Quarters = "Months") %>% filter(Quarters > 5) %>% ungroup() %>% filter(`Annualized Return (%)`>0)
CB_u <- CB_df %>% rename(Quarters = "Months") %>% filter(Quarters > 5) %>% ungroup() %>% filter(`Annualized Return (%)`<0)


i = CB_o %>% tibble::as_tibble()
  addtorow          <- list()
  addtorow$pos      <- list()
  addtorow$pos[[1]] <- c(0)
  addtorow$command  <- c(paste("\\hline \n",
                               "\\endhead \n",
                               "\\hline \n",
                               "{\\footnotesize Continued on next page} \n",
                               "\\endfoot \n",
                               "\\endlastfoot \n",sep=""))
r = CB_u %>% tibble::as_tibble()
  addtorow          <- list()
  addtorow$pos      <- list()
  addtorow$pos[[1]] <- c(0)
  addtorow$command  <- c(paste("\\hline \n",
                               "\\endhead \n",
                               "\\hline \n",
                               "{\\footnotesize Continued on next page} \n",
                               "\\endfoot \n",
                               "\\endlastfoot \n",sep=""))
  
  
table <- xtable(i, caption = "Over Performance in Interest Rate Regimes\\label{tab4}")
  print.xtable(table,
             tabular.environment = "longtable",
             floating = FALSE, # Leave this as is.
             table.placement = 'H', # Leave this as is.
             booktabs = T, # Aesthetics
             include.rownames = FALSE,  # Typically you don't want this in a table.
             add.to.row = addtorow, # For adding the Continued on next page part...
             comment = FALSE,
             caption.placement = 'bottom',  # Where do you want the caption?
             size="\\fontsize{12pt}{13pt}\\selectfont"  # Size of text in table..
             )
  
table <- xtable(r, caption = "Under Performance in Interest Rate Regimes\\label{tab5}")
  print.xtable(table,
             tabular.environment = "longtable",
             floating = FALSE, # Leave this as is.
             table.placement = 'H', # Leave this as is.
             booktabs = T, # Aesthetics
             include.rownames = FALSE,  # Typically you don't want this in a table.
             add.to.row = addtorow, # For adding the Continued on next page part...
             comment = FALSE,
             caption.placement = 'bottom',  # Where do you want the caption?
             size="\\fontsize{12pt}{13pt}\\selectfont"  # Size of text in table..
             )

```

Finally we consider a dynamic measure we evaluate risk adjusted performance dividend portfolios achieving their returns overtime. Figure \ref{fig1} illustrates the consistency in the performance of dividend portfolios by employing a rolling 60 month information ratio to avoid looking at short term events that may skew performance results. This ratio is computed by determining the rolling excess return of the index relative to its benchmark and then dividing this by the volatility of those excess returns. The red line represents out performance to the benchmark, whilst considering risk, thus a yardstick to consider satisfactory performance. UK_HY has delivered undesirable consistency in returns over the sample period, whilst The EM  and Japan dividend portfolios had a polarizing performances throughout the sample period. For one, from 2005 to 2015, returns for the portfolio were consistently positive. Since then, over the last 8 years information ratios for these portfolios have been negative. This contrasts South African portfolios, of which dividend growth portfolios have since 2010 to 2020 have shown positive information ratios. The SA_HY only turned positive since 2017. US and EU indexes have mirroring in intra region performance i.e. deliver ratios that close to 0 and dont deviate much from that mark over time. Therefore our analysis based on information ratios shows the same as our whole sample analysis on total return in \ref{tab1}, dividend strategies fail to out perform their benchmark, barring SA_HY (of which its information ratio has been in a steady decline). This is opposite to our results from stratification, where we see out performance of dividend strategies in low interest rate environment or periods of high volatility.  

```{r, fig.align='left', fig.cap="Rolling 3 Year Returns \\label{fig1}", fig.ext='png', fig.height=4, fig.width=7}

source("code/InformationRatioRoll.R")

a <-  df %>% Information_Ratio_Roll(., "EU_HY", "EU", 20030104, 60)
b <-  df %>% Information_Ratio_Roll(., "EU_DG", "EU_2",20030104, 60)
 c <- df %>% Information_Ratio_Roll(., "UK_HY", "UK", 20030104, 60)
 d <- df %>% Information_Ratio_Roll(., "UK_HY_B", "UK", 20030104, 60)
 e <- df %>% Information_Ratio_Roll(., "JP_HY", "JP", 20030104,60)
 f <- df %>% Information_Ratio_Roll(., "JP_DG", "JP", 20030104, 60)
 g <- df %>% Information_Ratio_Roll(., "EM_HY", "EM", 20030104, 60)
 h <- df %>% Information_Ratio_Roll(., "SA_HY", "SA", 20030104, 60)
 i <- df %>% Information_Ratio_Roll(., "SA_DG", "SA", 20030104, 60)
 j <- df %>% Information_Ratio_Roll(., "US_HY", "US", 20030104, 60)
 k <- df %>% Information_Ratio_Roll(., "US_DG", "US_2", 20030104, 60)

consistency_df <- list(a, b, c, d, e,f,g,h,i,j,k) %>%
  reduce(inner_join, by='date') %>% 
  gather(IR , ret, -date) 
 
consistency_df %>%
  ggplot() + 
  geom_line(aes(date, ret), color = "steelblue", size = 1.1, alpha = 0.8) +
  geom_hline(yintercept = 0, color = "red", size = 0.3, alpha = 0.5) +
  facet_wrap(~IR) +
  gabriel_theme +  
  labs(title = "Information Ratio Changes", subtitle = "Assessing return consistency", caption = "Source: Bloomberg and author calculations",  x = NULL)
```

# Application to South Africa{-}

## Backtest Results from Dividend Portfolio Signals{-}

Figure \ref{fig3} illustrates the cumulative returns of our dividend portfolios, accompanied by a display of the total capital invested during the sample period. The portfolio categories include those structured around Dividend Yield (DY), Dividend Growth (DG), Price Momentum, and Sustainability. These portfolios are compared to the performance benchmark represented by the SWIX Top 40 index.Consistent with our previous analysis of the SA_HY and SA_DG portfolios, a discernible pattern emerges, showing that the returns over the sample period fall short of the benchmark set by the market index. Additionally, our vanilla portfolio, the Dividend High Yield (HY), exhibits the lowest cumulative returns. Similarly, the Price Momentum and Sustainability portfolios demonstrate diminished performance when compared to both the Value and DG portfolios. This observation underscores a trend of under performance in our portfolios when evaluated against the broader market index.

This result calls for further examination and investigation to discern the underlying factors and potential implications within the context of dividend-oriented investment strategies.
```{r Figure3,  warning =  FALSE, fig.align = 'left', fig.cap = "Rolling 3 Year Returns \\label{fig3}", fig.ext = 'png', fig.height = 4, fig.width =7}
# Visuals on total ROI 

Loc <- "J433_J406/Divi/"
Loc_2 <- "J433_J406/Divi/Capped_SWIX/"
source("/Users/gabrielrambanapasi/Desktop/Much Ado Dividends/Much-Ado-Dividends/Thesis/write up/code/Get_dat_1.R")
source("/Users/gabrielrambanapasi/Desktop/Much Ado Dividends/Much-Ado-Dividends/Thesis/write up/code/EOM.R")
source("code/Theme.R")


df1 <- Get_dat(Loc, Loc_2,Port = "Divi1","Returns")
df2 <- Get_dat(Loc, Loc_2,Port = "Divi2","Returns")
df3 <- Get_dat(Loc, Loc_2,Port = "Divi3","Returns")
df4 <- Get_dat(Loc, Loc_2,Port = "Divi4","Returns")
dfbm <- Get_dat(Loc, Loc_2,Port = "Divi1","Returns_BM")
df <- bind_rows(df1, df2, df3, df4, dfbm %>% rename(Returns = BM_Returns) %>% mutate(Portfolio = "BM")) %>% select(date, Portfolio, Returns) %>% ungroup() %>% select(-YM)

# get the cumulative returns 

df %>% group_by(Portfolio) %>%  mutate(ROI = cumprod(1+Returns), ROI = ROI/first(ROI)) %>% ggplot + geom_line(aes(date, ROI, color = Portfolio))+gabriel_theme +  
  labs(title = " Return On Investment", subtitle = "Backtest Results on Dividend Portfolios", caption = "Source: Bloomberg and author calculations",  x = NULL)+
  gabriel_theme
```

Tables \ref{tab6} and \ref{tab7} provide a breakdown of total investments during periods characterized by market cycles and interest rate regimes. These periods are categorized as either high or low volatility and pertain to hiking or cutting cycles in response to realized market volatility and the interest rate regime, our stratifcation dates are etracted from those used in our analysis of \ref{tab2} and \ref{tab3} for the SA_HY and SA_DG indexes. Similar to that analysis, in our findings from internationally traded portfolios, we once again observe the advantageous qualities of dividend portfolios when stratified according to interest rate regimes and volatility levels. Notably, the dividend portfolios exhibit notable defensive attributes, with the price momentum-adjusted and sustainability portfolios yielding the highest returns during hiking periods and times of high volatility. Moreover, it is worth highlighting that our portfolios consistently outperform the market index during these periods.

```{r, results='asis'}
df_volatility <- bind_rows (df %>%  filter(date %in% hivol_per_vector_sa) %>% mutate(roi = cumprod(1+Returns)) %>% group_by(Portfolio) %>%  summarise(Months = n(), ROI  = last(roi),  `Ann ROI %` = ROI^Months/12 -1, `SD %` = sd(roi)) %>% mutate(MarketCycle = "High Volatility "),

df %>%  filter(date %in% lovol_per_vector_sa) %>% mutate(roi = cumprod(1+Returns)) %>% group_by(Portfolio) %>%   summarise(Months = n(), ROI  = last(roi),  `Ann ROI %` = ROI^Months/12 -1, `SD %`= sd(roi))  %>% mutate(MarketCycle = "Low Volatility ") )

library(xtable)
data <- df_volatility %>% select(-Months) %>%  tibble::as_tibble()

table <- xtable(data, caption = "Market Cycle Perforomance \\label{tab6} ")
  print.xtable(table,
             # tabular.environment = "longtable",
             floating = TRUE,
             table.placement = 'H',
             # scalebox = 0.3,
             comment = FALSE,
             caption.placement = 'bottom'
             )
```
Moerver, during cutting cycles or in times of low volatility, we observe the relationship is maintained as our market cycle analsysis on South African portfolios. In these scenarios, much like the overall return on investment, the market index appears to offer higher returns. Notably, among our portfolios, our HY portfolio that fails to deliver substantial returns compared to our other dividend-oriented strategies. Given this, we conclude that that dividend portfolios can be used as a tool for investors to add return in period of heightened market volatility. 

```{r, results= "asis"}
df_interest <- bind_rows(df %>%  filter(date %in% Hiking_date_vector_sa) %>% mutate(roi = cumprod(1+Returns)) %>% group_by(Portfolio) %>%  summarise(Months = n(), ROI  = last(roi),  `Ann ROI %` = ROI^4/Months -1, `SD %` = sd(roi))  %>% mutate(MarketCycle = "Hiking")%>% filter(Months >1),

df %>%  filter(date %in% Neutral_date_vector_sa) %>% mutate(roi = cumprod(1+Returns)) %>% group_by(Portfolio) %>%  summarise(Months = n(), ROI  = last(roi),  `Ann ROI %` = ROI^4/Months -1, `SD %` = sd(roi))  %>% mutate(MarketCycle = "Neutral")%>% filter(Months >1)  ,

df %>%  filter(date %in% Cutting_date_vector_sa) %>% mutate(roi = cumprod(1+Returns)) %>% group_by(Portfolio) %>%  summarise(Months = n(), ROI  = last(roi),  `Ann ROI %` = ROI^4/Months -1, `SD %` =sd(roi)) %>% mutate(MarketCycle = "Cutting")  %>% filter(Months >1) )

library(xtable)
data <- df_interest %>% select(-Months) %>% tibble::as_tibble()

table <- xtable(data, caption = "Interest Rate Regime Performance \\label{tab7}")
  print.xtable(table,
             # tabular.environment = "longtable",
             floating = TRUE,
             table.placement = 'H',
             # scalebox = 0.3,
             comment = FALSE,
             caption.placement = 'bottom'
             )
```

```{r}
df1_h <- Get_dat(Loc, Loc_2,Port = "Divi1","Holds") %>% mutate(Portfolio = "Divi1")
df2_h <- Get_dat(Loc, Loc_2,Port = "Divi2","Holds")%>% mutate(Portfolio = "Divi2")
df3_h <- Get_dat(Loc, Loc_2,Port = "Divi3","Holds")%>% mutate(Portfolio = "Divi3")
df4_h <- Get_dat(Loc, Loc_2,Port = "Divi4","Holds")%>% mutate(Portfolio = "Divi4")
dfh <- bind_rows(df1_h, df2_h, df3_h, df4_h) %>% ungroup() %>% select(-YM)

loc_bm <- list.files("J433_J406/Divi/Capped_SWIX/", pattern = "\\.rds$", full.names = TRUE)

dfh_bm <- loc_bm[grepl("Holdings.rds", loc_bm)] %>% read_rds(.) %>% select(date, Tickers, Name, BM_Weight = Weight, Sector ) %>% mutate(Sector = gsub("N/A", NA, Sector))  %>% Make_calendar_EOM(.)%>% arrange(date) %>%  ungroup()

dfh_bm <- dfh_bm  %>%
  mutate(Month = format(date, "%b"),Year = format(date, "%Y")) %>% 
  group_by(Year, Name) %>% 
  filter(Month %in% c("Oct")) %>% ungroup() %>% select(-Year , -Month) 
  
# selecting last quarter rebalancing

dfh <- dfh  %>%
  mutate(Month = format(date, "%b"),Year = format(date, "%Y")) %>% 
  group_by(Year, Name, Portfolio) %>% 
  filter(Month %in% c("Oct"))%>% ungroup() %>% select( -Month, -Year)

# get the deviations
dates_to_filter <- full_join(dfh, dfh_bm, by = c("date", "Name", "Tickers")) %>% select(-YM) %>% mutate(excess_wts = Weight - BM_Weight) %>% filter(!is.na(Weight)) %>% select(date) %>% arrange(date) %>% pull() %>% unique()

# I am looking into return attribution more than risk attribution, so lets analyze the impact of the active decisions from the divi portfolios. Maybe bring in some aspects of micro attribution, ones that are consistent with style.

# accucracy is imparove in short time intervals, most appropriate for little turnover
```

Finally, to assess when our dividend portfolios provide value, we evaluate their relative performance by taking the product excess returns and excess weights to give a relative performance measure. To do this, we simply calculated the difference in monthly excess returns from the last re balancing date in our back-test, which was October of each year, spanning from 2007-10-30 to 2022-10-30^[In our back-test results, on the date 2008-10-30, there were no weights available for any of the portfolios, so we excluded these dates from our analysis. As these were point measures and had no significant impact on long-term trends, our overall analysis remains unaffected.] While we do not consider sector returns and weights for portfolios and benchmarks, we modify the measure by collapsing the excess returns and excess weights to obtain return attribution for the overall strategy. Consequently, we can now assess nuances in performance that reward overweight/underweight decisions when it was opportune^[For a more in-depth background and the merits of our using this return attribution, see @brinson1985measuring.]

Figure \ref{fig4} illustrates our measure of relative return performance, considering the excess weights throughout our investment horizon.

```{r,  warning =  FALSE, fig.align = 'left', fig.cap = "Rolling 3 Year Returns \\label{fig4}", fig.ext = 'png', fig.height = 4, fig.width =7}
# from our excess returns calc , this data just has divi excess returns, join by date
Excess_returs_divi <- df %>% 
  filter(date %in% dates_to_filter) %>% 
  spread(Portfolio, Returns) %>%
  mutate_at(3:6, ~ (.)- BM ) %>% select(-BM) %>% ungroup() %>% 
  gather(index, ex_ret, -date)

#  excess weights 

Excess_weights <-  full_join(dfh_bm, dfh, by = c("date", "Name", "Tickers"))  %>%
  arrange(date) %>% 
filter(date %in% dates_to_filter) %>% 
filter(!is.na(Portfolio)) %>% 
group_by(Portfolio, date) %>%
summarize(Index_Weight =Weight/sum(Weight), BM_Weight = BM_Weight/sum(BM_Weight)) %>%
mutate(ExcessWeight = (Index_Weight - BM_Weight)) %>% 
  summarize( ExcessWeight= mean(ExcessWeight)) %>% spread(Portfolio, ExcessWeight) %>%
  gather(index, ex_weight, -date)

# combine to get the BR DF 
BF_df <- left_join(Excess_weights, Excess_returs_divi, c("date", "index")) %>% filter(!is.na(ex_weight)) %>%  mutate(BR = ex_weight * ex_ret) %>% select(date, BR, index)

#  there are momnets in which we dont have the ex_weight for all portfolios in 2008, just going to excleude them from the anal;ysis


g <- BF_df %>% 
  ggplot(aes(date, BR)) + 
  geom_smooth() + 
  facet_grid(~index) +
  gabriel_theme + 
  labs(title = " Relative Performance", subtitle = "Backtest Results on Dividend Portfolios", caption = "Source: Bloomberg and author calculations",  x = NULL)
g <- g + scale_y_continuous(labels = scales::number_format(scale = 0.01))

# get the hit range of the strategy throughout time 
Hit_df <- left_join(Excess_weights, Excess_returs_divi, by = c("date", "index")) %>%
  filter(!is.na(ex_weight)) %>%
  mutate(BR = ex_weight * ex_ret) %>%
  select(date, BR, index) %>%
  group_by(index) %>%
  mutate(Positive = sum(BR > 0), Tot = n()) %>% summarize(`Hit Rate` = mean(Positive/Tot ))

g +
  geom_text(
    data = Hit_df,
    aes(label = paste("Hit Rate:", scales::percent(`Hit Rate`))),
    x = Inf,
    y = Inf,
    hjust = 1,
    vjust = 1,
    show.legend = FALSE,
    nudge_x = -0.02
  )
```
In contrast to the results in Figure \ref{fig3}, where all dividend signals resulted in lower ROI over our back-test period, here our dividend portfolio outperformed the Capped SWIX Top 50 at different rates, measured by Hit Rates (HR). Specifically, Divi1 had a HR of 50%, Divi2 at 42.9%, Divi3 at 68.8%, and Divi4 at 31.2% of the time. Notably, our value portfolio (Divi 3) shows the highest HR, followed by Divi 1, Divi 2, and Divi 4, in that order. While the result from our ROI analysis is consistent with the first portfolio, the order of performance is different for portfolios Divi 4, Divi 1, and Divi 2. From this analysis, we conclude that using a proxy for value rather than a dividend signal adds more value to portfolio performance.

\newpage
# Conclusion {-}

Over time, dividend portfolios, whether HY or DG, have exhibited positive excess returns as indicated by excess cumulative returns. While the UK_HY index has shown the highest cumulative return, this trend is not consistently observed across other regional indexes. However, upon stratifying these portfolios according to different periods of market volatility, it becomes evident that during high volatility periods, dividend strategies offer capital protection when addeed to a portfolio of assets.Moreover,  in this case, HY strategies outperform DG strategies.  Surprisingly, portfolios based in South Africa (SA) tend to perform well during these high volatility periods, which is somewhat unconventional as such times are typically associated with a flight to safety, and Emerging Markets (EM) and, by extension, South Africa, are considered riskier. When extending our analysis to encompass interest rate cycles, we observe a contrasting effect compared to the volatility-based stratification. We find that all strategies appear to give the highest return in low interest rate cycles. 

Dividend strategies offer poor deliver poor return consistency, as measured by our information ratio. Initially, we discern that, at a broad level, dividend portfolios do not consistently maintain a positive ratio over an extended investment horizon. However, disparities in performance emerge. Notably, South African (SA) and dividend indexes have consistently delivered positive ratios over the past decade. In contrast, Emerging Markets (EM) and Japanese (JP) indexes have experienced substantial declines in their information ratios, despite seemingly consistent performance prior to 2015. Meanwhile, the United States (US), European Union (EU), and United Kingdom (UK) indexes have exhibited unpredictable performance over the sampled period.When we integrate our information ratio findings with drawdown analysis, we observe that advanced economies have experienced the fewest draw downs over the sample period, with the exception of the UK. This could suggest a relatively lower level of systematic risk in these economies. Conversely, South African (SA) and Emerging Market (EM) drawdowns have lower draawdowns, possibly indicating a reduced systematic risk in emerging markets.

In the context of South Africa and considering the top 50 companies by market capitalization, we note similar performance to our international analysis. Firstly, dividend portfolios don't offer convincing total returns, as measured by our cumulative returns calculations. However, their value emerges from high volatility and hiking cycles. Moreover, we observe that once we consider more traditional proxies for value, such as the Price to Earnings (P/E) ratio, the value of dividend signals diminishes. In other words, the P/E portfolios perform highly according to our backtest and performance criteria, notably outperforming the market index 68.8% of the time. To conclude, dividend portfolios are a poor proxy for value and investors are better placed to look into investment products to give an income component to portfolio total returns.  However, we note that investor preferences vary thus may propel demand for specific strategies for dividend portfolios. Given our evidence, investors under constraints investment policy statements should opt for equity portfolios constructed DG strategies, despite their lower hit rate, they possess lower volatility  in acheiving returns,  this will be the most profitable practical way of attaining returns close to the market index which is uninvestable. 

\newpage
# Appendix {-}

```{r, results='asis'}
p <- readxl::read_xlsx("data/Index Description.xlsx")

p = p %>% tibble::as_tibble()
addtorow          <- list()
addtorow$pos      <- list()
addtorow$pos[[1]] <- c(0)
addtorow$command  <- c(paste("\\hline \n",
                             "\\endhead \n",
                             "\\hline \n",
                             "{\\footnotesize Continued on next page} \n",
                             "\\endfoot \n",
                             "\\endlastfoot \n",sep=""))
table <- xtable(p, caption = "Index Description \\label{tabdes}")
print.xtable(table,
             tabular.environment = "longtable",
             floating = FALSE, # Leave this as is.
             table.placement = 'H', # Leave this as is.
             booktabs = T, # Aesthetics
             include.rownames = FALSE,  # Typically you don't want this in a table.
             add.to.row = addtorow, # For adding the Continued on next page part...
             comment = FALSE,
             caption.placement = 'bottom',  # Where do you want the caption?
             size="\\fontsize{8pt}{9pt}\\selectfont"  # Size of text in table..
)
```


# Dividend Defintions {-}

Bloomberg has two main categories for distributions: Cash Dividends and Stock Dividends. Various kinds of distributions appear under these definitions that do not necessarily only apply to ordinary issued shares (the only security type that we consider in our study). In the next two subsections we define the types of distributions that fall under these categories and in some cases provide additional information. Our sample only comprises of final, interim and regular cash dividends. These dividends are categorized by Bloomberg as Normal Cash. 

### Cash Dividends {-}
- Final: dividend declared for the financial year-end
- Interim (includes 2nd interim, 3rd interim and 4th interim): dividend paid after a reporting period (eg. quarterly or semi-annually)
Special Cash: dividend declared for the financial year-end or interim period over and above the normal dividend
- Regular Cash: a dividend distribution made in cash
- Omitted: A company has elected to skip a scheduled payment
- Discontinued: The discontinuance of dividend payments on an ongoing basis
- Interest on Capital: interest paid on fixed income instruments
- Income: mutual fund dividends, in most cases
- Liquidation: a distribution of a companies assets to shareholders during (interim) or after delisting (final)
- Return of Capital: a non-taxable cash payment to investors from the company that represents a return on invested capital as opposed to a
dividend
- Memorial: a special dividend. For example a company celebrating an anniversary might pay a memorial dividend
- Proceeds from sale of shares: a distribution of cash to shareholders after selling shares. For example this may occur when the company sells
the shares of a shareholder who was not eligible to receive shares in an offering and then distributes the proceeds to shareholders
- Cancelled: the cancellation of a previously declared dividend
- Return Premium: special cash dividend paid from a special reserve
- Preferred Rights Redemption: a company pays a dividend in exchange for previously issued preferred rights

# Stock Dividends {-}

Bonus: also known as a scrip or capitalization issue. Shareholders are given additional stock in proportion to their holdings
- Scrip: a free issue or bonus of shares
- Stock Dividend: portion of a company’s retained earnings that are distributed to shareholders in stock. The JSE treats stock dividends as a
capitalization issue
\newpage


# Appendix 2 {-}

# Principal Component Analysis Results {-}

```{r, results='asis'}
library(xtable)
 z <- readxl::read_xlsx("data/EM Index.xlsx")

table <- xtable(z, caption = "PCA Results")
  print.xtable(table,
             # tabular.environment = "longtable",
             floating = TRUE,
             table.placement = 'H',
             # scalebox = 0.3,
             comment = FALSE,
             caption.placement = 'bottom'
             )
  
w <- readxl::read_xlsx("data/EU index .xlsx")

 table <- xtable(w,  caption = "PCA Results")
   print.xtable(table,
              # tabular.environment = "longtable",
              floating = TRUE,
              table.placement = 'H',
              # scalebox = 0.3,
              comment = FALSE,
              caption.placement = 'bottom'
              )

 j <- readxl::read_xlsx("data/JP Index.xlsx")

 table <- xtable(j, caption = "PCA Results")
   print.xtable(table,
              # tabular.environment = "longtable",
              floating = TRUE,
              table.placement = 'H',
              # scalebox = 0.3,
              comment = FALSE,
              caption.placement = 'bottom'
              )

 t <- readxl::read_xlsx("data/SA index .xlsx")

 table <- xtable(t, caption = "PCA Results")
   print.xtable(table,
              # tabular.environment = "longtable",#
              floating = TRUE,
              table.placement = 'H',
             # scalebox = 0.3,
              comment = FALSE,
              caption.placement = 'bottom'
              )

 u <- readxl::read_xlsx("data/UK index.xlsx")

 table <- xtable(u, caption = "PCA Results")
   print.xtable(table,
              # tabular.environment = "longtable",
              floating = TRUE,
              table.placement = 'H',
              # scalebox = 0.3,
              comment = FALSE,
              caption.placement = 'bottom'
              )

 v <- readxl::read_xlsx("data/US index.xlsx")

 table <- xtable(v, caption = "PCA Results")
   print.xtable(table,
             # tabular.environment = "longtable",
              floating = TRUE,
              table.placement = 'H',
              # scalebox = 0.3,
              comment = FALSE,
              caption.placement = 'bottom'
              )

   
   
 k <- readxl::read_xlsx("data/World Index.xlsx")
             
 table <- xtable(k, caption = "PCA Results")
   print.xtable(table,
              # tabular.environment = "longtable",
              floating = TRUE,
              table.placement = 'H',
              # scalebox = 0.3,
              comment = FALSE,
              caption.placement = 'bottom'
              )
```
\newpage
# References {-}

<div id="refs"></div>




