}
stratifier(df, "US_HY", "US",  hivol_per_vector_us, "High Vol")
source("~/Desktop/Much Ado Dividends/Much-Ado-Dividends/Thesis/code/Stratifier.R")
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" )
)
source("code/Stratifier.R")
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" )
)
source("~/Desktop/Much Ado Dividends/Much-Ado-Dividends/Thesis/code/Stratifier.R")
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" )
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" )
)
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "SA_HY", "SA", lovol_per_vector_sa, "Low Vol Period" ),
stratifier(df, "SA_DG", "SA", lovol_per_vector_sa, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" )
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
#   get the vol data and get some dates
VIX <- vol_data %>% filter(deri == "VIX")
V2X <- vol_data %>% filter(deri == "V2X")
JSV <- vol_data %>% filter(deri== "SAVITOP40")
IVIUK <- vol_data %>% filter(deri== "IVIUK")
# get rolling sd for the volatility index
# US Strat
strat_df <- VIX %>% mutate(topQ = quantile(RollSD, probs = 0.9),
botQ = quantile(RollSD, probs = 0.1),
Strat = ifelse(RollSD >= topQ, "HiVol",
ifelse(RollSD <= botQ, "LowVol", "Normal_Vol")))
# # US strat
hivol_per_vector_us <- strat_df %>% filter(Strat %in% "HiVol") %>% pull(Date)
lovol_per_vector_us <- strat_df %>% filter(Strat %in% "LowVol") %>% pull(Date)
#
# # Europe strat
strat_df <- V2X %>% mutate(topQ = quantile(RollSD, probs = 0.9),
botQ = quantile(RollSD, probs = 0.1),
Strat = ifelse(RollSD >= topQ, "HiVol",
ifelse(RollSD <= botQ, "LowVol", "Normal_Vol")))
#
hivol_per_vector_eu  <- strat_df %>% filter(Strat %in% "HiVol") %>% pull(Date)
lovol_per_vector_eu  <- strat_df %>% filter(Strat %in% "LowVol") %>% pull(Date)
#
# # SA
strat_df <- JSV %>% mutate(topQ = quantile(RollSD, probs = 0.9),
botQ = quantile(RollSD, probs = 0.1),
Strat = ifelse(RollSD >= topQ, "HiVol",
ifelse(RollSD <= botQ, "LowVol", "Normal_Vol")))
#
hivol_per_vector_sa <- strat_df %>% filter(Strat %in% "HiVol") %>% pull(Date)
lovol_per_vector_sa <- strat_df %>% filter(Strat %in% "LowVol") %>% pull(Date)
# Getting excess return for the period and indices
#  High Vol df
source("code/Stratifier.R")
Hivol_performance <-  bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" )
)
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
source("code/Stratifier.R")
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" )
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" )
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" )
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" )
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" )
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" )
)
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "SA_HY", "SA", lovol_per_vector_sa, "Low Vol Period" ),
stratifier(df, "SA_DG", "SA", lovol_per_vector_sa, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
stratifier <- function(raw_df, index_name, benchmark_name, Date_vector, Description) {
Mk_df <- raw_df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>%
gather(Vehicle, Value, -Date) %>%
mutate(YM = format(Date, "%b %y")) %>%
filter(Date %in% Date_vector) %>%
group_by(YM, Vehicle) %>%
mutate(Return = Value / lag(Value) - 1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl_xts(cols_to_xts = Return, spread_by = Vehicle) %>%
xts_tbl() %>%
mutate(ex.ret = (Index - Benchmark)) %>%
mutate(YM = format(date, "%b %y")) %>%
select(date, ex.ret, YM) %>%
group_by(YM) %>%
mutate(Return = cumprod(1 + ex.ret)) %>%
summarize("Market Period" = Description, Days = n(), annualized_return = last(Return) ^ (255 / Days) - 1) %>%
summarize("Market Period" = Description, "Annualized Return" = mean(annualized_return))
Mk_df
}
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "SA_HY", "SA", lovol_per_vector_sa, "Low Vol Period" ),
stratifier(df, "SA_DG", "SA", lovol_per_vector_sa, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
stratifier <- function(raw_df, index_name, benchmark_name, Date_vector, Description) {
Mk_df <- raw_df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>%
gather(Vehicle, Value, -Date) %>%
mutate(YM = format(Date, "%b %y")) %>%
filter(Date %in% Date_vector) %>%
group_by(YM, Vehicle) %>%
mutate(Return = Value / lag(Value) - 1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl_xts(cols_to_xts = Return, spread_by = Vehicle) %>%
xts_tbl() %>%
mutate(ex.ret = Index - Benchmark) %>%
mutate(YM = format(date, "%b %y")) %>%
select(date, ex.ret, YM) %>%
group_by(YM) %>%
mutate(Return = cumprod(1 + ex.ret)) %>%
summarize("Market Period" = Description, Days = n(), annualized_return = last(Return) ^ (255 / Days) - 1) %>%
summarize("Market Period" = Description, "Annualized Return" = mean(annualized_return))
Mk_df
}
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" )
#  Low Vol df
Lovol_performance <-  bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "SA_HY", "SA", lovol_per_vector_sa, "Low Vol Period" ),
stratifier(df, "SA_DG", "SA", lovol_per_vector_sa, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" )
stratifier(df, "SA_HY", "SA", lovol_per_vector_sa, "Low Vol Period" )
df
stratifier(df, "SA_HY", "SA", lovol_per_vector_sa, "Low Vol Period" )
lovol_per_vector_sa <- strat_df %>% filter(Strat %in% "LowVol") %>% pull(Date)
Hivol_performance <-  bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" )
Hivol_performance <-  bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" )
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" )
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" )
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" )
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" )
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" )
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
stratifier <- function(raw_df, index_name, benchmark_name, Date_vector, Description) {
Mk_df <- raw_df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>%
gather(Vehicle, Value, -Date) %>%
mutate(YM = format(Date, "%b %y")) %>%
filter(Date %in% Date_vector) %>%
group_by(YM, Vehicle) %>%
mutate(Return = Value / lag(Value) - 1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl_xts(cols_to_xts = Return, spread_by = Vehicle) %>%
xts_tbl() %>%
mutate(ex.ret = Index - Benchmark) %>%
mutate(YM = format(date, "%b %y")) %>%
select(date, ex.ret, YM) %>%
group_by(YM) %>%
mutate(Return = cumprod(1 + ex.ret)) %>%
summarize("Market Period" = Description, Days = n(), annualized_return = last(Return) ^ (255 / Days) - 1) %>%
summarize(Name = !!glue("{index_name}"), "Market Period" = Description, "Annualized Return" = mean(annualized_return))
Mk_df
}
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" )
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" )
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" )
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" )
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
stratifier <- function(raw_df, index_name, benchmark_name, Date_vector, Description) {
Mk_df <- raw_df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>%
gather(Vehicle, Value, -Date) %>%
mutate(YM = format(Date, "%b %y")) %>%
filter(Date %in% Date_vector) %>%
group_by(YM, Vehicle) %>%
mutate(Return = Value / lag(Value) - 1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl_xts(cols_to_xts = Return, spread_by = Vehicle) %>%
xts_tbl() %>%
mutate(ex.ret = Index - Benchmark)  %>%
select(date, ex.ret)  %>%
mutate(Return = cumprod(1 + ex.ret)) %>%
summarize(Name = !!glue("{index_name}"), "Market Period" = Description, Days = n(),  "Annualized Return" = mean(last(Return) ^ (255 / Days) - 1))
Mk_df
}
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" )
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" )
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
stratifier <- function(raw_df, index_name, benchmark_name, Date_vector, Description) {
Mk_df <- raw_df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>%
gather(Vehicle, Value, -Date) %>%
mutate(YM = format(Date, "%b %y")) %>%
filter(Date %in% Date_vector) %>%
group_by(YM, Vehicle) %>%
mutate(Return = Value / lag(Value) - 1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl_xts(cols_to_xts = Return, spread_by = Vehicle) %>%
xts_tbl() %>%
mutate(ex.ret = Index - Benchmark)  %>%
select(date, ex.ret)  %>%
mutate(Return = cumprod(1 + ex.ret)) %>%
summarize(Name = !!glue("{index_name}"), "Market Period" = Description, Days = n(),  "Annualized Return" = mean(last(Return) ^ (255 / Days) - 1)*100,"Annualized Return" = !!glue("{Annualized Return}%"))
Mk_df
}
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" )
stratifier <- function(raw_df, index_name, benchmark_name, Date_vector, Description) {
Mk_df <- raw_df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>%
gather(Vehicle, Value, -Date) %>%
mutate(YM = format(Date, "%b %y")) %>%
filter(Date %in% Date_vector) %>%
group_by(YM, Vehicle) %>%
mutate(Return = Value / lag(Value) - 1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl_xts(cols_to_xts = Return, spread_by = Vehicle) %>%
xts_tbl() %>%
mutate(ex.ret = Index - Benchmark)  %>%
select(date, ex.ret)  %>%
mutate(Return = cumprod(1 + ex.ret)) %>%
summarize(Name = !!glue("{index_name}"), "Market Period" = Description, Days = n(), "Annualized Return" = mean(last(Return) ^ (255 / Days) - 1)*100)
Mk_df
}
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" )
source("~/Desktop/Much Ado Dividends/Much-Ado-Dividends/Thesis/code/Stratifier.R")
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" )
source("~/Desktop/Much Ado Dividends/Much-Ado-Dividends/Thesis/code/Stratifier.R")
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "SA_HY", "SA", hivol_per_vector_sa, "High Vol Period" ),
stratifier(df, "SA_DG", "SA", hivol_per_vector_sa, "High Vol Period" ))
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
bind_rows(
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
bind_rows(
stratifier(df, "EU_HY", "EU", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "EU_DG", "EU_2", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "UK_HY_B", "UK", hivol_per_vector_eu, "High Vol Period" ),
stratifier(df, "JP_HY", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "JP_DG", "JP", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "EM_HY", "EM", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_HY", "US", hivol_per_vector_us, "High Vol Period" ),
stratifier(df, "US_DG", "US", hivol_per_vector_us, "High Vol Period" ))
bind_rows(
stratifier(df, "EU_HY", "EU", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "EU_DG", "EU_2", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "UK_HY_B", "UK", lovol_per_vector_eu, "Low Vol Period" ),
stratifier(df, "JP_HY", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "JP_DG", "JP", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "EM_HY", "EM", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_HY", "US", lovol_per_vector_us, "Low Vol Period" ),
stratifier(df, "US_DG", "US", lovol_per_vector_us, "Low Vol Period" )
)
