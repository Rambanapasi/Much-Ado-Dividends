df}
b <- df %>% part(., "FUDP", "M2EFDY")
View(b)
part  <-  function(df, index_name, benchmark_name) {
df = df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = replace(Return, is.na(Return), 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl() %>%
mutate(Excess_Return = Index - Benchmark) %>%
mutate(YM = format(Date, "%Y-%b")) %>%
group_by(YM) %>%
filter(Date == last(Date)) %>%
mutate(Cumulative_Excess_Return = cumprod(1 + Excess_Return))
df}
b <- df %>% part(., "FUDP", "M2EFDY")
part  <-  function(df, index_name, benchmark_name) {
df = df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = replace(Return, is.na(Return), 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl() %>%
mutate(Excess_Return = Index - Benchmark)
b <- df %>% part(., "FUDP", "M2EFDY")
df %>% part(., "FUDP", "M2EFDY"
df %>% part(., "FUDP", "M2EFDY")
df %>% part(., "FUDP", "M2EFDY")
df %>% part(., "FUDP", "M2EFDY")
part  <-  function(df, index_name, benchmark_name) {
df = df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = replace(Return, is.na(Return), 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl()
part  <-  function(df, index_name, benchmark_name) {
df = df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = replace(Return, is.na(Return), 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl()
# mutate(Excess_Return = Index - Benchmark) %>%
# mutate(YM = format(Date, "%Y-%b")) %>%
# group_by(YM) %>%
# filter(Date == last(Date)) %>%
# mutate(Cumulative_Excess_Return = cumprod(1 + Excess_Return))
df}
b <- df %>% part(., "FUDP", "M2EFDY")
b
df %>% part(., "FUDP", "M2EFDY")
function(df, index_name, benchmark_name) {
df = df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = replace(Return, is.na(Return), 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df
}
part  <-  function(df, index_name, benchmark_name) {
df = df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = replace(Return, is.na(Return), 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df
}
df %>% part(., "FUDP", "M2EFDY")
View(part)
part  <-  function(df, index_name, benchmark_name) {
df = df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
b
# names
df %>%
distinct(.,) %>% names()
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
A <- df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
A <- df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
A <- df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
A <- df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
A <- df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
A <- df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
A <- df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
A <- df %>%
dplyr::rename(Index = "FUDP", Benchmark = "M2EFDY") %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name)
# select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
# mutate(Return = Value / lag(Value)-1) %>%
# mutate(Return = coalesce(Return, 0)) %>%
# tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
# tbl2xts::xts_tbl
df
}
df <- readxl::read_xlsx("data/MAD .xlsx")
b <- df %>% part(., "FUDP", "M2EFDY")
library(tidyverse)
b <- df %>% part(., "FUDP", "M2EFDY")
View(b)
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date)
# mutate(Return = Value / lag(Value)-1) %>%
# mutate(Return = coalesce(Return, 0)) %>%
# tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
# tbl2xts::xts_tbl
df
}
df %>% part(., "FUDP", "M2EFDY")
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle ) %>%
tbl2xts::xts_tbl
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0))
#  tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle) %>%
# tbl2xts::xts_tbl
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
b
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle)
# tbl2xts::xts_tbl
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0))
# tbl2xts::tbl_xts(.,cols_to_xts = Value, spread_by = Vehicle)
# tbl2xts::xts_tbl
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
b
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Return, spread_by = Vehicle)
# tbl2xts::xts_tbl
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Return, spread_by = Vehicle) %>%
tbl2xts::xts_tbl
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Return, spread_by = Vehicle) %>%
tbl2xts::xts_tbl()
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
b
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Return, spread_by = Vehicle) %>%
tbl2xts::xts_tbl() %>%
mutate(ex.ret = Index - Benchmark) %>%
mutate(cum_return = cumprod(1+ex.ret)) %>%
select(Date, cum_return)
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
part  <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Return, spread_by = Vehicle) %>%
tbl2xts::xts_tbl() %>%
mutate(ex.ret = Index - Benchmark) %>%
mutate(cum_return = cumprod(1+ex.ret)) %>%
select(date, cum_return)
df
}
b <- df %>% part(., "FUDP", "M2EFDY")
b
tail(b)
MY_excess_return <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Return, spread_by = Vehicle) %>%
tbl2xts::xts_tbl() %>%
mutate(ex.ret = Index - Benchmark) %>%
mutate(cum_return = cumprod(1+ex.ret)) %>%
select(date, cum_return)
df
}
df %>% distinct() %>% names()
b <- df %>% part(., "GDUEEGF", "M2EFDY")
b
tail(b)
View(MY_excess_return)
MY_excess_return <-  function(df, index_name, benchmark_name) {
df <-  df %>%
dplyr::rename(Index = index_name, Benchmark = benchmark_name) %>%
select(Date, Index, Benchmark) %>% gather(Vehicle, Value, -Date) %>%
mutate(Return = Value / lag(Value)-1) %>%
mutate(Return = coalesce(Return, 0)) %>%
tbl2xts::tbl_xts(.,cols_to_xts = Return, spread_by = Vehicle) %>%
tbl2xts::xts_tbl() %>%
mutate(ex.ret = Index - Benchmark) %>%
mutate(cum_return = cumprod(1+ex.ret)) %>%
select(date, cum_return) %>%
rename(., index_name = cum_return)
df
}
library(knitr)
Table_data <- readxl::read_xlsx("data/Systematic Indices and Benchmarks.xlsx")
knitr::kable(Table_data)
gc()
gc()
